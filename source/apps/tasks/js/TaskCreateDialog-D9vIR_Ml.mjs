/*! third party licenses: js/vendor.LICENSE.txt */
import{_,c as p,a as o,t as c,b as C,m as x,o as n,bQ as D,ab as M,l as $,am as z,D as I,an as B,bP as P,a3 as O,S as f,a5 as U,W as A,bR as E,G as k,x as l,e as d,d as t,w,v as b,I as h}from"./store-DE2z1cMA.mjs";const L={name:"ViewHeadlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},W=["aria-hidden","aria-label"],G=["fill","width","height"],Q={d:"M4,5V7H21V5M4,11H21V9H4M4,19H21V17H4M4,15H21V13H4V15Z"},R={key:0};function Z(i,r,s,T,e,a){return n(),p("span",x(i.$attrs,{"aria-hidden":s.title?null:!0,"aria-label":s.title,class:"material-design-icon view-headline-icon",role:"img",onClick:r[0]||(r[0]=g=>i.$emit("click",g))}),[(n(),p("svg",{fill:s.fillColor,class:"material-design-icon__svg",width:s.size,height:s.size,viewBox:"0 0 24 24"},[o("path",Q,[s.title?(n(),p("title",R,c(s.title),1)):C("",!0)])],8,G))],16,W)}const j=_(L,[["render",Z]]),q={name:"TaskCreateDialog",components:{CalendarPickerItem:D,Check:M,NcButton:$,NcEmptyContent:z,NcLoadingIcon:I,NcModal:B,TextBoxOutline:P,ViewHeadline:j},props:{summary:{type:String,default:""},description:{type:String,default:""}},emits:["close"],data(){return{pendingSummary:"",pendingDescription:"",pendingCalendar:null,loading:!0,creating:!1,created:!1,newTask:null}},computed:{...O({writableCalendars:"getSortedWritableCalendars",defaultCalendar:"getDefaultCalendar"}),createdMessage(){return f("tasks",'"{task}" was added to "{calendar}"',{task:this.pendingSummary,calendar:this.pendingCalendar.displayName},void 0,{sanitize:!1,escape:!1})}},beforeMount(){this.fetchCalendars()},mounted(){this.pendingSummary=this.summary,this.pendingDescription=this.description},methods:{...U(["createTask"]),t:f,changeCalendar(i){this.pendingCalendar=i},close(){this.$emit("close"),this.$root.$emit("close")},async fetchCalendars(){this.loading=!0,await A.connect({enableCalDAV:!0}),await this.$store.dispatch("fetchCurrentUserPrincipal"),await this.$store.dispatch("getCalendarsAndTrashBin"),this.pendingCalendar=this.writableCalendars[0],this.loading=!1},async addTask(){this.creating=!0;const i={summary:this.pendingSummary,note:this.pendingDescription,calendar:this.pendingCalendar};this.newTask=await this.createTask(i),this.creating=!1,this.created=!0},openNewTask(){window.location=E("apps/tasks")+"/#/calendars/".concat(this.pendingCalendar.id,"/tasks/").concat(this.newTask.uri)}}},F={key:0,id:"modal-inner"},J={key:0,class:"loading-overlay"},K={class:"property property__summary"},X=["placeholder","disabled"],Y={class:"property property__notes"},ee=["disabled"],ae={class:"modal-buttons"},te={key:1,id:"modal-inner"};function ne(i,r,s,T,e,a){const g=d("NcLoadingIcon"),v=d("CalendarPickerItem"),N=d("ViewHeadline"),S=d("TextBoxOutline"),m=d("NcButton"),y=d("NcEmptyContent"),V=d("Check"),H=d("NcModal");return n(),k(H,{class:"task-selector",size:"small",onClose:a.close},{default:l(()=>[!e.creating&&!e.created?(n(),p("div",F,[e.loading?(n(),p("div",J,[t(g,{size:40})])):C("",!0),o("h3",null,c(a.t("tasks","Create a new task")),1),t(v,{disabled:e.loading,calendar:e.pendingCalendar,calendars:i.writableCalendars,onChangeCalendar:a.changeCalendar},null,8,["disabled","calendar","calendars","onChangeCalendar"]),o("div",K,[t(N,{size:20}),w(o("input",{"onUpdate:modelValue":r[0]||(r[0]=u=>e.pendingSummary=u),type:"text",placeholder:a.t("tasks","Task summary"),disabled:e.loading},null,8,X),[[b,e.pendingSummary]])]),o("div",Y,[t(S,{size:20}),w(o("textarea",{"onUpdate:modelValue":r[1]||(r[1]=u=>e.pendingDescription=u),disabled:e.loading},null,8,ee),[[b,e.pendingDescription]])]),o("div",ae,[t(m,{onClick:a.close},{default:l(()=>[h(c(a.t("tasks","Cancel")),1)]),_:1},8,["onClick"]),t(m,{disabled:e.loading,type:"primary",onClick:a.addTask},{default:l(()=>[h(c(a.t("tasks","Create task")),1)]),_:1},8,["disabled","onClick"])])])):(n(),p("div",te,[e.creating?(n(),k(y,{key:"creating",description:a.t("tasks","Creating the new taskâ€¦")},{icon:l(()=>[t(g)]),_:1},8,["description"])):e.created?(n(),k(y,{key:"created",description:a.createdMessage},{icon:l(()=>[t(V)]),action:l(()=>[t(m,{onClick:a.close},{default:l(()=>[h(c(a.t("tasks","Close")),1)]),_:1},8,["onClick"]),t(m,{type:"primary",onClick:a.openNewTask},{default:l(()=>[h(c(a.t("tasks","Open task")),1)]),_:1},8,["onClick"])]),_:1},8,["description"])):C("",!0)]))]),_:1},8,["onClose"])}const se=_(q,[["render",ne],["__scopeId","data-v-243d05ff"]]);export{se as T};
