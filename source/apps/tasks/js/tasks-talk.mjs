/*! third party licenses: js/vendor.LICENSE.txt */
import{T as g}from"./TaskCreateDialog-D9vIR_Ml.mjs";import{c2 as p,c3 as k,S as l,bR as w}from"./store-DE2z1cMA.mjs";const f=(t,s={})=>new Promise((i,e)=>{const n=document.createElement("div");document.getElementById("body-user").append(n);const o=p(t,{...s,onClose(){o.$el.remove(),e(new Error("Selection canceled"))}}).use(k).mount(n)});window.addEventListener("DOMContentLoaded",()=>{var t,s;(s=(t=window.OCA)==null?void 0:t.Talk)!=null&&s.registerMessageAction&&window.OCA.Talk.registerMessageAction({label:l("tasks","Create a task"),icon:"icon-tasks",async callback({message:{message:i,messageParameters:e,actorDisplayName:n},metadata:{name:o,token:d}}){const r=i.replace(/{[a-z0-9-_]+}/gi,function(c){const a=c.substr(1,c.length-2);if(e[a]){if(e[a].type==="file"&&e[a].path)return e[a].path;if(e[a].type==="user"||e[a].type==="call")return"@"+e[a].name;if(e[a].name)return e[a].name}return c}),m=r.replace(/^(.{255}[^\s]*).*/,"$1"),u=m===""?r.substr(0,255):m;try{await f(g,{summary:u,description:r+"\n\n["+l("tasks","Message from {author} in {conversationName}",{author:n,conversationName:o})+"]("+w("/call/"+d)+")"})}catch{console.debug("Task creation dialog was canceled")}}})});
